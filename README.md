The code has the following features:

Support for handling non-alphabetic characters.
Allow the user to choose whether to preserve or remove non-alphabetic characters during encryption/decryption.
Implement error handling for invalid input.
Allow the user to specify whether to perform a left or right shift.
Provide options for brute-force decryption to try all possible shift values.
